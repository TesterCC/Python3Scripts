#!/usr/bin/env python
# -*- coding:utf-8 -*-
__author__ = 'MFC'
__time__ = '18/11/2 15:11'

# a script for id num analysis, source from network

import requests
from pyquery import PyQuery as pq

# Run in terminal
# python analysis_id_num.py

def test(id):
    url = "https://shenfen.supfree.net/search.asp?id=" + id
    timeout = 5
    headers = {'Accept': 'text/html, application/xhtml+xml, image/jxr, */*',
               'Accept-Encoding': 'gzip, deflate, br',
               'TE': 'Trailers',
               'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Firefox/62.0 Safari/537.36 Edge/15.15063'}

    r = requests.get(url, timeout=timeout, headers=headers)
    r.encoding = 'gbk'

    res = r.text
    doc = pq(res)
    tb = doc(".ctable tr td")
    info = []
    for i in tb.items():
        i = i.text().replace(u' (生日配对 生日密码 历史上的今天)', '')
        info.append(i)
    print("%s,%s,%s,%s" % (info[1], info[3], info[5], info[7]))


# read id nums data
with open("id.txt", "r") as f:
    for each in f:
        each = each.strip()
        try:
            test(each)
        except:
            print(each + " error!")

    print("ID num analysis is finished!!!")




